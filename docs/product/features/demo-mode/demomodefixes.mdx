---
title: "DEMO_MODE_FIXES"
description: "Demo mode currently uses real user data (your personal schedule, classes, etc.) instead of mock data."
---

# Demo Mode Fixes - Implementation Summary

**Date:** January 2025  
**Status:** ‚úÖ Critical fixes completed  
**Remaining:** Mock data implementation (backend work)

---

## ‚úÖ Fixes Applied

### 1. **Infinity Portal Prevention**
- **Problem:** Demo was recursively loading landing page within itself
- **Fix:** Demo route now ALWAYS redirects to `/dashboard/home`, never landing page
- **File:** `app/demo/page.tsx`
- **Change:** Hardcoded redirect to `/dashboard/home` instead of using `redirectTo` from API

### 2. **Logo Routing Disabled in Embed Mode**
- **Problem:** Logo in top-left routed back to home page, causing recursion
- **Fix:** Logo is non-clickable when `embed=true` parameter is present
- **File:** `components/NavBar.tsx`
- **Change:** Conditional rendering - shows non-clickable div when embedded, Link when not

### 3. **"Demo is read-only" Error Handling**
- **Problem:** Preferences API throws error when trying to save in demo mode
- **Fix:** Gracefully handle read-only errors, return current preferences without throwing
- **File:** `lib/preferences.ts`
- **Change:** Check for "read-only" in error message, return current preferences instead of throwing

### 4. **Access Token 401 Error Handling**
- **Problem:** 401 errors in demo/embed mode were causing failures
- **Fix:** Better handling of 401 in demo mode - retry but don't throw on final attempt
- **File:** `lib/ensureAccessToken.ts`
- **Change:** Detect demo/embed mode, allow requests to proceed even if token fetch fails

---

## üîÑ Remaining Work: Mock Data Implementation

### Current Issue
Demo mode currently uses real user data (your personal schedule, classes, etc.) instead of mock data.

### Required Changes

#### 1. Create Demo User with Mock Data
- **Location:** Backend (API Router or database)
- **Action:** Create a dedicated demo user account with:
  - Mock course schedule (3-4 sample courses)
  - Mock assignments (distributed across Do Now/Up Next/Due Soon)
  - Mock syllabi (sample course materials)
  - Mock workload scores
  - Mock Ace insights

#### 2. Sample Mock Data Structure
```json
{
  "courses": [
    {
      "code": "ECON 301",
      "name": "Intermediate Microeconomics",
      "semester": "Fall 2025",
      "assignments": [
        {
          "title": "Problem Set 3",
          "dueDate": "2025-11-15",
          "lane": "do-now"
        },
        {
          "title": "Midterm Exam",
          "dueDate": "2025-11-22",
          "lane": "up-next"
        }
      ],
      "workload": "6.5/10"
    },
    {
      "code": "CS 101",
      "name": "Introduction to Computer Science",
      "semester": "Fall 2025",
      "assignments": [
        {
          "title": "Lab Assignment 5",
          "dueDate": "2025-11-18",
          "lane": "up-next"
        }
      ],
      "workload": "4.0/10"
    }
  ],
  "aceInsights": [
    "Your ECON 301 midterm is in 2 weeks. Start reviewing chapters 5-8.",
    "You have a light week coming up - good time to get ahead on CS 101."
  ]
}
```

#### 3. Backend Changes Needed
- **Demo User Creation:** Ensure `demo@dormway.app` has mock data seeded
- **API Endpoints:** Modify dashboard endpoints to return mock data when `X-Demo-Mode: true` header is present
- **Data Isolation:** Ensure demo user data is completely separate from real users

#### 4. Frontend Changes (If Needed)
- **Dashboard:** Should automatically use mock data when `isDemoUser === true`
- **No Changes Required:** Current code should work once backend returns mock data

---

## üé® UI/UX Improvements Made

### 1. **Better Error Handling**
- Preferences errors no longer crash the app
- Access token errors handled gracefully in demo mode

### 2. **Prevented Navigation Issues**
- Logo doesn't route when embedded
- Demo always goes to dashboard, never landing page

### 3. **Improved User Experience**
- Demo mode is clearly read-only (errors handled gracefully)
- No infinite recursion possible

---

## üìã Testing Checklist

- [x] Demo route redirects to `/dashboard/home` (not landing page)
- [x] Logo doesn't route when `embed=true`
- [x] "Demo is read-only" error handled gracefully
- [x] Access token 401 errors handled in demo mode
- [ ] Mock data displays in demo (requires backend work)
- [ ] Demo user has separate mock schedule/assignments
- [ ] Demo mode shows realistic student experience

---

## üöÄ Next Steps

1. **Backend:** Create mock data for demo user
2. **Backend:** Modify API to return mock data when `X-Demo-Mode: true`
3. **Testing:** Verify demo shows mock data, not real user data
4. **UI/UX:** Add visual indicator that demo is read-only (optional)

---

## üîç Files Modified

1. `app/demo/page.tsx` - Always redirect to dashboard/home
2. `components/NavBar.tsx` - Disable logo routing in embed mode
3. `lib/preferences.ts` - Handle read-only errors gracefully
4. `lib/ensureAccessToken.ts` - Better 401 handling in demo mode
