---
title: "AMPLITUDE_GAP_ANALYSIS"
description: "This document analyzes the current state of event tracking across DormWay's platforms (iOS, Web, Backend) and provides a detailed migration plan to standardi..."
---

# Amplitude Event Tracking - Gap Analysis & Migration Plan

**Date**: 2025-09-29
**Status**: Draft for Review

## Executive Summary

This document analyzes the current state of event tracking across DormWay's platforms (iOS, Web, Backend) and provides a detailed migration plan to standardize all event tracking according to the unified schema defined in `AMPLITUDE_EVENT_SCHEMA.md`.

### Key Findings

- **Web (dormway-lockedin)**: 21 events currently tracked, mostly ad-hoc naming
- **Backend (Engine)**: 9 predefined server events, needs expansion
- **iOS**: No Amplitude integration yet
- **Gap**: ~60+ standardized events missing across platforms
- **Inconsistency**: Event names don't follow snake_case convention
- **Missing Properties**: Standard properties (platform, app_version, etc.) not consistently included

---

## Current State Audit

### 1. Web Events (dormway-lockedin)

#### Currently Tracked Events

| Current Event Name | Status | Standard Event Name | Priority | Notes |
|-------------------|--------|---------------------|----------|-------|
| `ambassador_button_available` | ‚ö†Ô∏è Rename | N/A (feature-specific) | Low | Keep as-is or remove if not needed |
| `ambassador_button_clicked` | ‚ö†Ô∏è Rename | N/A (feature-specific) | Low | Keep as-is or remove if not needed |
| `ambassador_form_available` | ‚ö†Ô∏è Rename | N/A (feature-specific) | Low | Keep as-is or remove if not needed |
| `homepage_viewed` | ‚ö†Ô∏è Rename | `app_opened` | High | Map to standard event + context |
| `homepage_demo_clicked` | ‚ö†Ô∏è Rename | Custom | Medium | Consider generic `cta_clicked` |
| `homepage_inline_file_selected` | ‚ö†Ô∏è Rename | `syllabus_uploaded` (partial) | High | Map to upload flow |
| `homepage_inline_file_dropped` | ‚ö†Ô∏è Rename | `syllabus_uploaded` (partial) | High | Map to upload flow |
| `homepage_inline_upload_submit` | ‚ö†Ô∏è Rename | `syllabus_uploaded` | High | Consolidate upload events |
| `homepage_inline_upload_failed` | ‚ö†Ô∏è Rename | `syllabus_parsing_failed` | High | Use standard error event |
| `homepage_inline_upload_success` | ‚ö†Ô∏è Rename | `syllabus_parsed` | High | Use standard success event |
| `notes_opened` | ‚úÖ OK | Keep as feature-specific | Medium | Add standard properties |
| `cmdk_used` | ‚ö†Ô∏è Rename | `search_performed` | Medium | Map to search event |
| `cmdk_result_selected` | ‚ö†Ô∏è Rename | `search_performed` | Medium | Include result_selected property |
| `schedule_week_changed` | ‚ö†Ô∏è Rename | `calendar_viewed` | Medium | Map to calendar event with view_type |
| `class_drawer_opened` | ‚ö†Ô∏è Rename | Feature-specific | Low | Keep with standard properties |
| `class_detail_mode` | ‚ö†Ô∏è Rename | Feature-specific | Low | Keep with standard properties |
| `today_drawer_opened` | ‚ö†Ô∏è Rename | `calendar_viewed` | Medium | Map to calendar event |
| `keyboard_shortcut_guide_opened` | ‚ö†Ô∏è Rename | `help_accessed` | Low | Map to help event |
| `keyboard_shortcut_used` | ‚ö†Ô∏è Rename | Feature-specific | Low | Keep with standard properties |
| `post_analysis_cta_clicked` | ‚ö†Ô∏è Rename | Custom CTA event | Low | Consider generic pattern |
| `test_consent_tracking` | ‚ùå Remove | N/A | Low | Test event - remove |

**Web Summary**:
- ‚úÖ Keep as-is: 0
- ‚ö†Ô∏è Needs renaming/mapping: 20
- ‚ùå Remove: 1
- **Total events tracked**: 21

**Missing Critical Web Events**:
- `account_created`
- `account_login` / `account_logout`
- `onboarding_started` / `onboarding_completed`
- `schedule_imported` / `schedule_refresh_triggered`
- `assignment_created` / `assignment_completed`
- `calendar_viewed` (standardized)
- `event_created` / `event_edited` / `event_deleted`
- All Premium & Monetization events
- All Social & Network events
- All Error handling events
- All Viral & Growth events

---

### 2. Backend Events (Engine)

#### Currently Tracked Server Events

| Current Event Name | Status | Standard Event Name | Priority | Notes |
|-------------------|--------|---------------------|----------|-------|
| `user_registered` | ‚ö†Ô∏è Rename | `account_created` | High | Rename to match schema |
| `onboarding_completed` | ‚úÖ OK | `onboarding_completed` | High | Already matches! |
| `first_syllabus_uploaded` | ‚ö†Ô∏è Rename | `syllabus_uploaded` | High | Rename, track all uploads |
| `dashboard_generated` | ‚ö†Ô∏è Rename | Feature-specific | Medium | Keep with standard properties |
| `context_prediction_requested` | ‚úÖ OK | Server-only | Medium | Added standard properties (source/surface/data sources) |
| `context_prediction_completed` | ‚úÖ OK | Server-only | Medium | Tracks success/failure, latency, confidence buckets |
| `context_prediction_background` | ‚úÖ OK | Server-only | Medium | Replaces legacy `context_predicted`; includes sources + trigger |
| `weekly_summary_generated` | ‚ö†Ô∏è Rename | Feature-specific | Medium | Keep with standard properties |
| `braingains_completed` | ‚ö†Ô∏è Rename | Feature-specific | Medium | Keep with standard properties |
| `schedule_synced` | ‚ö†Ô∏è Rename | `schedule_imported` | High | Rename to match schema |
| `milestone_achieved` | ‚úÖ OK | `milestone_achieved` | Medium | Keep as-is, define milestones |

**Backend Summary**:
- ‚úÖ Matches schema: 2
- ‚ö†Ô∏è Needs renaming: 7
- **Total events tracked**: 9

**Missing Critical Backend Events**:
- `schedule_refresh_completed`
- `syllabus_parsed` / `syllabus_parsing_failed`
- `lms_connected` / `lms_connection_failed`
- `school_verified`
- `grade_predicted`
- `reminder_triggered`
- All Premium purchase events
- All Referral/conversion events
- All Error tracking events (`api_request_failed`, `sync_failed`)

---

### 3. iOS Events

#### Current Status
- ‚ùå **No Amplitude SDK integrated**
- ‚ùå **No event tracking implemented**

**Required iOS-Specific Events** (63 total):
- All 11 Account & Authentication events
- All 10 Onboarding events
- All 11 Core Academic events
- All 6 Calendar & Schedule events
- All 6 Navigation & Discovery events (iOS-only!)
- All 6 Social & Network events
- All 7 Premium & Monetization events
- All 9 Engagement & Retention events
- All 4 Error & Technical events
- All 5 Viral & Growth events

**iOS Priority**:
1. **High**: Account, Onboarding, Core Academic (basic functionality)
2. **Medium**: Calendar, Engagement, Error tracking
3. **Low**: Social, Premium, Navigation (can be phased in)

---

## Gap Analysis Summary

### Events by Category

| Category | Schema Defines | Web Has | Backend Has | iOS Has | Gap |
|----------|----------------|---------|-------------|---------|-----|
| Account & Auth | 6 | 0 | 1 | 0 | **5 missing** |
| Onboarding | 10 | 0 | 1 | 0 | **9 missing** |
| Core Academic | 11 | 5 (non-standard) | 3 | 0 | **6 missing** |
| Calendar & Schedule | 6 | 3 (non-standard) | 0 | 0 | **4 missing** |
| Navigation & Discovery | 6 | 0 | 0 | 0 | **6 missing (iOS-only)** |
| DormWay Lock | 4 | 0 | 0 | 0 | **4 missing** |
| Social & Network | 6 | 0 | 0 | 0 | **6 missing** |
| Premium & Monetization | 7 | 0 | 0 | 0 | **7 missing** |
| Engagement & Retention | 9 | 4 (non-standard) | 0 | 0 | **7 missing** |
| Error & Technical | 4 | 0 | 0 | 0 | **4 missing** |
| Viral & Growth | 5 | 0 | 0 | 0 | **5 missing** |
| **TOTAL** | **74** | **21** | **9** | **0** | **63 gaps** |

### Priority Breakdown

| Priority | Events | Description |
|----------|--------|-------------|
| **P0 - Critical** | 18 | Account, Onboarding core flow, Schedule import |
| **P1 - High** | 22 | Syllabus upload, Calendar, Search, Basic engagement |
| **P2 - Medium** | 20 | Social features, Premium, Advanced engagement |
| **P3 - Low** | 14 | iOS Navigation, Deals, Feature-specific events |

---

## Migration Strategy

### Phase 1: Foundation (Week 1)
**Goal**: Establish consistent tracking infrastructure

#### Backend
- [ ] Update `EventTracker` service to support all 74 schema events
- [ ] Add TypeScript types from `shared/types/amplitude-events.ts`
- [ ] Rename existing events:
  - `user_registered` ‚Üí `account_created`
  - `first_syllabus_uploaded` ‚Üí `syllabus_uploaded`
  - `schedule_synced` ‚Üí `schedule_imported`
- [ ] Add standard properties to all existing events
- [ ] Add new critical server events:
  - `syllabus_parsed` / `syllabus_parsing_failed`
  - `schedule_refresh_completed`
  - `lms_connected` / `lms_connection_failed`

#### Web
- [ ] Copy TypeScript types to `services/dormway-lockedin/src/types/`
- [ ] Update `amplitude.ts` to support typed events
- [ ] Create `eventHelpers.ts` to auto-inject standard properties
- [ ] Update existing events to include standard properties

### Phase 2: Web Event Standardization (Week 1-2)
**Goal**: Migrate all existing web events to schema

- [ ] **Homepage & Upload Flow** (P0):
  - Map upload events ‚Üí `syllabus_uploaded` (single event with upload_method)
  - Add `app_opened` for homepage views
  - Track upload errors properly

- [ ] **Navigation & Search** (P1):
  - Rename `cmdk_used` ‚Üí `search_performed`
  - Add missing search properties

- [ ] **Calendar & Schedule** (P1):
  - Rename `schedule_week_changed` / `today_drawer_opened` ‚Üí `calendar_viewed`
  - Add view_type property

- [ ] **Feature-specific Events** (P2):
  - Keep `notes_opened`, `class_drawer_opened`, etc. with standard properties
  - Add platform, timestamp, app_version

### Phase 3: New Web Events (Week 2-3)
**Goal**: Add missing critical events

- [ ] **Authentication** (P0):
  - `account_created` (signup flow)
  - `account_login` / `account_logout`
  - `email_verified`

- [ ] **Onboarding** (P0):
  - `onboarding_started` / `onboarding_step_completed` / `onboarding_completed`
  - `school_selected` / `school_verified`
  - `academic_info_entered`
  - `schedule_source_selected`

- [ ] **Academic Features** (P1):
  - `schedule_imported` / `schedule_refresh_triggered`
  - `assignment_created` / `assignment_completed` / `assignment_deleted`
  - `exam_added`

- [ ] **Calendar & Events** (P1):
  - `event_created` / `event_edited` / `event_deleted`
  - `reminder_set`

### Phase 4: Web Advanced Events (Week 3-4)
**Goal**: Add engagement, error, and growth tracking

- [ ] **DormWay Lock** (P1):
  - `lock_accessed` / `lock_schedule_shared`
  - `lock_view_received` / `lock_conversion`

- [ ] **Error Tracking** (P1):
  - `error_occurred` (global error boundary)
  - `api_request_failed` (axios interceptor)

- [ ] **Engagement** (P2):
  - `feature_discovered`
  - `help_accessed`
  - `feedback_submitted`

- [ ] **Viral & Growth** (P2):
  - `invite_sent` / `invite_opened`
  - `share_initiated` / `share_completed`

### Phase 5: iOS Implementation (Week 3-5)
**Goal**: Full iOS Amplitude integration

- [ ] **SDK Integration**:
  - Install Amplitude iOS SDK
  - Create Swift EventTracker service
  - Import TypeScript types ‚Üí Swift enums/structs

- [ ] **Core Events** (P0):
  - All Account & Authentication events
  - All Onboarding events
  - Basic academic events (schedule, assignments)

- [ ] **Engagement Events** (P1):
  - `app_opened` / `app_backgrounded`
  - `notification_received` / `notification_opened`
  - `search_performed`

- [ ] **iOS-Specific Events** (P2):
  - Campus navigation events
  - `campus_map_viewed` / `building_searched`
  - `navigation_started` / `navigation_completed`

### Phase 6: Backend Expansion (Week 4-5)
**Goal**: Complete server-side event coverage

- [ ] **Premium & Monetization** (P2):
  - `premium_purchased` / `premium_cancelled`
  - `deal_redeemed`

- [ ] **Referral & Growth** (P2):
  - `referral_completed`
  - Track invite conversions

- [ ] **Advanced Academic** (P2):
  - `grade_predicted`
  - Additional LMS events

---

## Testing & Validation Plan

### 1. Development Testing
Each event implementation must include:
- [ ] TypeScript types match schema
- [ ] All standard properties included
- [ ] Event visible in Amplitude Live View within 60s
- [ ] Properties have correct data types

### 2. Staging Validation
- [ ] Create test user flows for each event category
- [ ] Verify events appear in Amplitude dashboard
- [ ] Check CustomerIO integration (if applicable)
- [ ] Validate event property values

### 3. Production Monitoring
- [ ] Set up Amplitude funnels for key flows (signup, onboarding, schedule import)
- [ ] Create alerts for missing critical events
- [ ] Monitor event volume and error rates
- [ ] Weekly review of data quality

---

## Implementation Checklist

### Before Starting
- [x] Event schema documented (`AMPLITUDE_EVENT_SCHEMA.md`)
- [x] TypeScript types created (`shared/types/amplitude-events.ts`)
- [ ] Schema approved by Product & Engineering
- [ ] Amplitude workspace configured
- [ ] CustomerIO integration enabled in Amplitude

### Backend
- [ ] EventTracker service updated with all events
- [ ] TypeScript types imported
- [ ] All workflows migrated to standard events
- [ ] Standard properties added to all events
- [ ] Tests added for event tracking

### Web (dormway-lockedin)
- [ ] TypeScript types imported
- [ ] Amplitude helper functions updated
- [ ] All existing events migrated
- [ ] New events implemented
- [ ] Global error boundary tracking
- [ ] API interceptor for error tracking

### iOS
- [ ] Amplitude iOS SDK integrated
- [ ] EventTracker service created
- [ ] Types/enums defined in Swift
- [ ] Core events implemented
- [ ] iOS-specific events implemented

### Documentation
- [ ] Team trained on new schema
- [ ] Amplitude dashboard created
- [ ] Event tracking guide published
- [ ] CustomerIO campaigns updated

---

## Success Metrics

### Week 2
- ‚úÖ 100% of existing events migrated to schema
- ‚úÖ All events include standard properties
- ‚úÖ P0 events implemented on Web

### Week 4
- ‚úÖ P0 + P1 events implemented on Web
- ‚úÖ Backend expanded with new events
- ‚úÖ iOS SDK integrated with P0 events

### Week 6
- ‚úÖ All P0-P2 events implemented across platforms
- ‚úÖ Event volume baseline established
- ‚úÖ Amplitude dashboards configured
- ‚úÖ CustomerIO integration validated

### Long-term
- üìä 95% event delivery success rate
- üìä < 5% events with missing properties
- üìä Weekly data quality review
- üìä Quarterly schema updates

---

## Risks & Mitigation

| Risk | Impact | Likelihood | Mitigation |
|------|--------|------------|------------|
| Breaking existing analytics | High | Medium | Gradual rollout, keep old events during migration |
| Event name conflicts | Medium | Low | Namespace legacy events with `legacy_` prefix |
| Missing properties | Medium | High | Validation in CI/CD, Amplitude schema checks |
| CustomerIO integration issues | High | Medium | Test integration before full rollout |
| Team adoption | Medium | Medium | Clear documentation, training sessions |
| Performance impact | Low | Low | Events are async, batched automatically |

---

## Next Steps

1. **Review & Approval**: Share this analysis with Product, Engineering, Data teams
2. **Prioritize**: Confirm P0-P3 priorities align with business goals
3. **Assign Owners**: Assign backend, web, iOS implementation to teams
4. **Set Timeline**: Confirm 6-week timeline or adjust based on capacity
5. **Kick Off Phase 1**: Start backend foundation work

---

**Document Owner**: Engineering Team
**Last Updated**: 2025-09-29
**Status**: Draft - Awaiting Approval
