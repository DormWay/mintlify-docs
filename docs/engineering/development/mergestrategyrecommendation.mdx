---
title: "MERGE_STRATEGY_RECOMMENDATION"
description: "cd .repos/dormway-platform"
---

# Merge Strategy Recommendation

**Date:** November 11, 2025  
**Current Branch:** `fix/theme-hardening`  
**Status:** 1 commit ahead, 2 commits behind, 25 uncommitted files

---

## üìä Current Situation

### Your Work (Committed)
- ‚úÖ **Theme hardening** (`f28da8e6`) - Removed legacy themes, fixed dark mode

### Your Work (Uncommitted)
- üöß **Landing page refactor** - Vertical layout, upload form consolidation
- üöß **Component extraction** - New landing page components
- üöß **Aurora WebGL fixes** - Theme-aware rendering
- üöß **CSS improvements** - Hero gradients, theme variables
- üöß **NavBar updates** - Navigation improvements (‚ö†Ô∏è **CONFLICT RISK**)

### Main Work (Need to Merge)
- ‚úÖ **Demo mode fixes** (#482) - Navigation, dates, data display
- ‚úÖ **Legal compliance** (#483) - Labs program documentation

---

## ‚ö†Ô∏è Conflict Analysis

### HIGH RISK: `NavBar.tsx`
**Main changes:**
- Added `DemoLink` component imports
- Wrapped logo and nav links with `DemoLink` to preserve demo query params
- Added `demoRouter` for programmatic navigation

**Your changes:**
- Navigation improvements (uncommitted)
- Theme-related updates

**Resolution Strategy:**
- Main's DemoLink changes are **critical** for demo mode functionality
- Your navigation changes need to be preserved
- **Solution:** Accept main's DemoLink integration, then re-apply your navigation improvements on top

### MEDIUM RISK: `page.tsx` (Landing Page)
**Main changes:**
- Fixed iframe URL to include `demoStatic=true` parameter

**Your changes:**
- Major landing page refactor (1367 lines changed)
- Component extraction
- Upload form integration

**Resolution Strategy:**
- Main's change is likely a small iframe URL fix
- Your refactor is extensive but in different areas
- **Solution:** Merge both - main's URL fix should be preserved in your refactored structure

### MEDIUM RISK: `useDashboardComposite.ts`
**Main changes:**
- Demo data integration
- Date fixes (Nov 3 ‚Üí Nov 10)

**Your changes:**
- Hook updates (uncommitted)

**Resolution Strategy:**
- Review both changes carefully
- Main's demo data changes are likely additive
- **Solution:** Merge both, ensure demo data logic is preserved

### LOW RISK: `careers/page.tsx`
**Main changes:**
- Minor Labs program copy updates (3 lines)

**Your changes:**
- Page updates (uncommitted)

**Resolution Strategy:**
- Likely different sections
- **Solution:** Merge both, review for overlap

---

## üéØ Recommended Approach: **Staged Merge**

### Phase 1: Save Your Work
**Goal:** Commit uncommitted changes to preserve your work

```bash
cd .repos/dormway-platform

# Review what you're committing
git status
git diff --stat

# Commit your landing page and component work
git add -A
git commit -m "feat: landing page refactor - vertical layout, upload form consolidation

- Extracted landing page components (HowItWorksWithUpload, etc.)
- Integrated upload form into Step 1
- Added theme-aware Aurora rendering
- Improved CSS variable system for hero gradients
- Updated NavBar navigation
- Various component and hook improvements"
```

### Phase 2: Merge Main
**Goal:** Bring in demo mode fixes and legal docs

```bash
# Fetch latest
git fetch origin

# Merge main (creates merge commit)
git merge origin/main

# If conflicts occur, resolve them (see conflict resolution below)
```

### Phase 3: Resolve Conflicts (If Any)

#### For `NavBar.tsx`:
1. **Accept main's DemoLink imports:**
   ```typescript
   import { DemoLink } from '@/components/DemoLink';
   import { createDemoRouter } from '@/lib/demoRouter';
   ```

2. **Preserve main's DemoLink usage** for logo and nav links:
   ```typescript
   <DemoLink href={user ? "/dashboard" : "/"} ...>
   ```

3. **Re-apply your navigation improvements** around the DemoLink wrappers

4. **Test:** Ensure demo mode navigation works AND your improvements are preserved

#### For `page.tsx`:
1. **Locate main's iframe URL fix** (likely near the top)
2. **Preserve it** in your refactored structure
3. **Ensure** your component extraction doesn't break the iframe URL logic

#### For `useDashboardComposite.ts`:
1. **Review main's demo data changes**
2. **Merge** with your hook updates
3. **Ensure** demo date logic (Nov 10) is preserved

### Phase 4: Test Everything

**Critical Test Cases:**
- [ ] Landing page loads correctly
- [ ] Upload form works
- [ ] Theme switching works (light/dark/glass)
- [ ] Demo mode navigation works (all links preserve query params)
- [ ] Demo mode shows Nov 10 as today
- [ ] Dayplan blocks display correctly
- [ ] NavBar navigation works in both normal and demo mode
- [ ] No console errors

---

## üîÑ Alternative: Rebase Strategy

If you prefer a cleaner history (linear, no merge commit):

```bash
# Save your work
git add -A
git commit -m "feat: landing page refactor..."

# Rebase onto main
git fetch origin
git rebase origin/main

# Resolve conflicts as they appear (same strategy as above)
# After each conflict resolution:
git add <resolved-files>
git rebase --continue

# If you get stuck:
git rebase --abort  # Start over
```

**Pros:** Cleaner history, easier to review  
**Cons:** More complex conflict resolution, rewrites commit history

**Recommendation:** Use **merge** (safer, preserves history)

---

## üìã Pre-Merge Checklist

Before merging:
- [ ] All uncommitted work is saved (committed or stashed)
- [ ] You understand what main's commits do
- [ ] You've reviewed the conflict risk areas
- [ ] You have time to resolve conflicts and test

After merging:
- [ ] All conflicts resolved
- [ ] Code compiles without errors
- [ ] All test cases pass (see Phase 4 above)
- [ ] Demo mode works end-to-end
- [ ] Landing page works end-to-end
- [ ] Theme switching works

---

## üö® If Things Go Wrong

### Rollback Merge:
```bash
git merge --abort  # If merge hasn't completed
git reset --hard HEAD~1  # If merge commit was created
```

### Start Fresh:
```bash
# Create a backup branch
git branch backup/fix-theme-hardening

# Reset to before merge
git reset --hard origin/fix/theme-hardening

# Try again with different strategy
```

---

## üí° Key Insights

1. **Main's DemoLink changes are critical** - They fix demo mode navigation
2. **Your landing page refactor is extensive** - Worth preserving
3. **Conflicts are manageable** - Main changes are mostly additive
4. **NavBar is the main concern** - But resolution is straightforward (accept DemoLink, re-apply your changes)

---

## ‚úÖ Recommended Next Steps

1. **Commit your uncommitted work** (Phase 1)
2. **Merge main** (Phase 2)
3. **Resolve NavBar conflict** by accepting DemoLink and re-applying your changes
4. **Test thoroughly** (Phase 4)
5. **Push and create PR** when ready

---

**Estimated Time:** 30-60 minutes (depending on conflict complexity)
