---
title: "CLERK_ZUPLO_QUICK_REF"
description: "./scripts/dev/diagnose-clerk-setup.sh"
---

# Clerk + Zuplo Quick Reference

## üöÄ Quick Start

```bash
# Run diagnostic
./scripts/dev/diagnose-clerk-setup.sh

# Fix and restart
make down && make dev

# Test
open http://localhost:3008
```

## üîë Required Environment Variables

### Doppler (for dormway-lockedin)
```bash
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_test_...
CLERK_SECRET_KEY=sk_test_...  # optional
```

### Zuplo (.env file at dormway-api-2/)
```bash
CLERK_ISSUER_URL=https://humorous-peacock-79.clerk.accounts.dev
CLERK_JWKS_URL=https://humorous-peacock-79.clerk.accounts.dev/.well-known/jwks.json
CLERK_FRONTEND_API_URL=https://humorous-peacock-79.clerk.accounts.dev
API_GATEWAY=http://api-router:3001
GATEWAY_KEY=wibhuqwuJnEzfKi8bJp65rHlsGFdzlZWHUv3pNXKEMADtMSarJYQWo2iwpFDMqhT
```

## ü©∫ Diagnostic Commands

```bash
# Check Doppler config
doppler setup --no-interactive

# Check Clerk key
doppler secrets get NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY --plain

# Check Zuplo config
cat ~/Development/GitHub/dormway-api-2/.env | grep CLERK

# Test Clerk endpoint
curl https://humorous-peacock-79.clerk.accounts.dev/.well-known/jwks.json

# Check service status
make status

# Check specific logs
make logs s=lockedin
make zuplo-logs
```

## üîß Common Fixes

### Missing Clerk Key Error
```bash
doppler secrets set NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY="pk_test_..." --config dev_riley
make rs s=lockedin
```

### Zuplo 401/403 Errors
```bash
cd ~/Development/GitHub/dormway-api-2
# Edit .env to ensure CLERK_* variables match Clerk instance
make zuplo-restart
```

### Services Not Starting
```bash
make down
doppler setup  # Verify config
make dev
```

## üìç Service Ports

- **3008**: LockedIn (Next.js with Clerk)
- **9000**: Zuplo Gateway
- **3001**: API Router (backend)

## üß™ Test Checklist

- [ ] `curl http://localhost:9000/health` ‚Üí 200 OK
- [ ] `curl http://localhost:3001/health` ‚Üí 200 OK
- [ ] `curl http://localhost:3008` ‚Üí Page loads
- [ ] Browser console at localhost:3008 ‚Üí No Clerk errors
- [ ] Click "Sign In" ‚Üí Redirects to Clerk (not error)

## üìö Full Documentation

- **Detailed Guide**: `docs/RILEY_CLERK_ZUPLO_SETUP.md`
- **Main Dev Guide**: `CLAUDE.md`
- **Zuplo Docs**: `~/Development/GitHub/dormway-api-2/CLAUDE.md`

## üÜò Emergency Reset

```bash
cd ~/Development/GitHub/dormway-platform
make down
docker system prune -f
doppler setup
make dev
./scripts/dev/diagnose-clerk-setup.sh
```

## üí¨ Get Help

1. Run diagnostic: `./scripts/dev/diagnose-clerk-setup.sh`
2. Check logs: `make logs s=lockedin`
3. Check Zuplo: `make zuplo-logs`
4. Review: `docs/RILEY_CLERK_ZUPLO_SETUP.md`
5. Ask in #dormway-dev Slack

---

**Last Updated**: 2025-10-29
