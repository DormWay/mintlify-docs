---
title: "DormWay Development Status   August 2025"
description: "1. **Auth0 ID Isolation** (2025-08-02)"
---

# DormWay Development Status - August 2025

#status #development #architecture #migration

**Last Updated**: 2025-08-02
**Primary Focus**: Backend Infrastructure & Auth Migration

## ğŸ¯ Current Sprint Focus

### Completed This Week âœ…
1. **Auth0 ID Isolation** (2025-08-02)
   - Lambda Authorizer extracts backend UUID from JWT
   - iOS TelemetryService uses backend UUID
   - Student context lookups fixed
   - Auth0 IDs no longer propagate beyond auth layer

2. **Docker Development Environment** (2025-07-26)
   - Full Docker Compose setup for local development
   - Observability stack (Grafana, Prometheus, Loki, Tempo)
   - PM2 deprecated in favor of Docker
   - Makefile automation for common tasks

3. **Aurora Database Migration** (2025-07-26)
   - PostgreSQL 15.4 local development
   - AuroraDb service implementation
   - Supabase adapter for compatibility
   - Database connection pooling

### In Progress ğŸ”„
1. **Database Schema Issues**
   - Missing tables: calendar events, notification analytics
   - Need to run/create migrations
   - Some queries failing with relation errors

2. **iOS App Stabilization**
   - Onboarding flow refinements
   - Widget system implementation
   - Context data collection

3. **Backend Services**
   - Temporal workflows using backend UUIDs
   - Ably real-time messaging consolidation
   - API Gateway header forwarding

## ğŸ—ï¸ Architecture Overview

### Service Status
| Service | Status | Notes |
|---------|--------|-------|
| **Engine** | âœ… Running | Temporal workflows, student processing |
| **API Router** | âœ… Running | Express gateway, Auth0 integration |
| **Ably Relay** | âœ… Running | Real-time telemetry relay |
| **Crews** | âœ… Running | Python AI agents for assistance |
| **PostgreSQL** | âœ… Running | Local Aurora-compatible DB |
| **LocalStack** | âœ… Running | AWS services emulation |
| **iOS App** | ğŸ”„ Dev | DormWayFresh with proper DI |

### Key URLs (Docker Environment)
- API Router: http://localhost:3001
- Engine: http://localhost:3030
- Grafana: http://localhost:3334 (admin/admin)
- Ably Relay: http://localhost:3032
- Crews: http://localhost:8000

## ğŸ” Authentication Flow

```
iOS App â†’ API Gateway â†’ Lambda Authorizer â†’ Backend Services
         JWT with         â†“                    â†“
         Auth0 ID    Extracts UUID      Only Backend UUIDs
```

### JWT Claims Structure
```json
{
  "sub": "auth0|xxx",  // Auth0 ID (not used by backend)
  "https://dormway.app/backend_user_id": "uuid",  // Backend UUID (primary)
  "https://dormway.app/user_id": "auth0|xxx",     // Legacy, being phased out
  "https://dormway.app/email": "user@example.com"
}
```

## ğŸ“Š Database Schema

### Core Tables
- `accounts` - User accounts with backend UUIDs
- `contexts` - Student, campus, city contexts
- `service_data` - Partitioned telemetry data
- `engine_notification_*` - Notification system tables
- `buildings`, `classrooms` - Campus infrastructure

### Missing Tables (Need Migration)
- User calendar events
- Notification analytics
- Some index optimizations

## ğŸš€ Deployment Status

### LocalStack (Development) âœ…
- API Gateway configured
- Lambda Authorizer deployed
- All services accessible via ngrok

### AWS Production ğŸ”„
- Infrastructure via Terraform
- Lambda Authorizer ready for deployment
- Need to verify all environment variables

## ğŸ“± iOS App Status

### DormWayFresh Architecture
- **No Singletons**: Pure dependency injection
- **Protocol-Based**: All services behind protocols
- **@Observable**: Modern Swift observation
- **Modular Packages**: 
  - DWServices (networking, external APIs)
  - DWDataCollection (telemetry, health, location)
  - DWContext (context management)
  - DWWidgets (widget system)
  - DWDesign (design system)

### Current Implementation
- âœ… Authentication flow with backend UUIDs
- âœ… Telemetry service sending correct IDs
- âœ… Onboarding flow (needs UI polish)
- ğŸ”„ Data collection infrastructure
- ğŸ”„ Widget intelligence system
- ğŸ“‹ Home tab contextual layouts
- ğŸ“‹ Campus tab features

## ğŸ› Known Issues

1. **Database Errors**
   ```
   ERROR: relation "user_calendar_events" does not exist
   ERROR: relation "notification_analytics" does not exist
   ```

2. **UI/UX Issues**
   - Onboarding flow needs refinement
   - Some navigation inconsistencies
   - Widget layouts need optimization

3. **Performance**
   - Some Temporal workflows need optimization
   - Database query performance tuning needed

## ğŸ“ˆ Metrics & Monitoring

### Observability Stack
- **Grafana**: Centralized dashboards
- **Prometheus**: Metrics collection  
- **Loki**: Log aggregation
- **Tempo**: Distributed tracing
- **PortKey**: LLM call tracking

### Key Metrics to Track
- Workflow execution times
- API response times
- Database query performance
- Real-time message latency
- LLM API costs

## ğŸ¯ Next Steps

### Immediate (This Week)
1. Run database migrations for missing tables
2. Deploy Lambda Authorizer to production
3. Fix remaining UI issues in iOS app
4. Complete widget system implementation

### Short Term (2 Weeks)
1. Launch beta testing program
2. Implement remaining data collectors
3. Build context intelligence features
4. Performance optimization pass

### Medium Term (1 Month)
1. Campus-specific features
2. Advanced notification intelligence
3. Study planning integration
4. Analytics dashboard

## ğŸ“š Related Documentation

- 2025-08-02 Auth0 ID Isolation Complete
- [Lambda Authorizer Backend UUID Migration](/docs/engineering/technical/migration-deployment/lambda-authorizer-backend-uuid-migration)
- [Docker Development Workflow](/docs/engineering/technical/development-guides/docker-development-workflow)
- [Aurora Local Development Strategy](/docs/engineering/technical/infrastructure/aurora-local-development-strategy)
- [iOS Local Development Guide](/docs/engineering/technical/infrastructure/ios-local-development-guide)

## ğŸ”— Quick Links

- [GitHub Repo](https://github.com/ethanbailie/dormway-dev-tools)
- [Temporal Cloud UI](https://cloud.temporal.io)
- [Supabase Dashboard](https://app.supabase.com)
- [Auth0 Dashboard](https://manage.auth0.com)
- [CustomerIO Dashboard](https://fly.customer.io)

## ğŸ’¡ Development Tips

1. **Always use Docker**: `make obs-full` for full stack
2. **Check logs**: `make api-logs`, `make engine-logs`
3. **Doppler for secrets**: `doppler run -- <command>`
4. **Test with ngrok**: `ngrok http 4566` for API Gateway
5. **Clear iOS app data**: Delete app to reset onboarding

---

*This document is the source of truth for current development status. Update regularly.*
