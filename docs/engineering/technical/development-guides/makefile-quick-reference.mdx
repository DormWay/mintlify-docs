---
title: "Makefile Quick Reference"
description: "make rs s=lockedin    # Quick restart service (NEW!) make rb s=admin       # Rebuild service (NEW!) make ll s=api         # Live logs (NEW!) make dc..."
---

# Makefile Quick Reference - DormWay Platform

**Location:** `/Users/ekaplan/Development/GitHub/dormway-platform/Makefile`  
**Created:** August 18, 2025  
**Last Updated:** October 26, 2025  
**Purpose:** Streamlined development commands for monorepo

## üöÄ Most Used Commands

### ‚ö° Quick Shortcuts (2025-10-26 Update)
```bash
make rs s=lockedin    # Quick restart service (NEW!)
make rb s=admin       # Rebuild service (NEW!)
make ll s=api         # Live logs (NEW!)
make dc                # Check environment health (NEW!)
make c                 # Show containers (NEW!)

# Service name shortcuts:
# lockedin ‚Üí dormway-lockedin
# api ‚Üí api-router  
# admin ‚Üí dormway-admin
# crews ‚Üí dormway-crews
# ably ‚Üí ably-relay
# canvas ‚Üí canvas-sync
# syllabus ‚Üí syllabus-webviewer
```

### Classic Commands
```bash
make dev        # Start everything
make stop       # Stop everything
make logs       # View all logs
make status     # Check health
make restart    # Restart all
```

## üìã Complete Command Reference

### ‚ö° Quick Shortcuts (2025-10-26 Update)

| Command | Shortcut | Description |
|---------|----------|-------------|
| `make rs s=<service>` | Quick restart | Restart service quickly |
| `make rb s=<service>` | Quick rebuild | Rebuild with deps |
| `make ll s=<service>` | Live logs | View logs from start |
| `make dc` | Health check | Check environment |
| `make c` | Containers | Show running containers |

**Service Name Shortcuts** (use with `s=`):
- `api` ‚Üí `api-router`
- `lockedin` ‚Üí `dormway-lockedin`
- `admin` ‚Üí `dormway-admin`
- `crews` ‚Üí `dormway-crews`
- `ably` ‚Üí `ably-relay`
- `canvas` ‚Üí `canvas-sync`
- `syllabus` ‚Üí `syllabus-webviewer`
- `plugin` ‚Üí `plugin-runner`

**Example**: `make rs s=lockedin` (restarts dormway-lockedin)

### Development Environment

| Command | Description | Example |
|---------|-------------|---------|
| `make dev` | Start all services with local PostgreSQL | `make dev` |
| `make dev-build` | Start with forced rebuild | `make dev-build` |
| `make dev-fresh` | Fresh start with Aurora sync | `make dev-fresh` |
| `make stop` | Stop all services | `make stop` |
| `make down` | Stop and remove containers | `make down` |
| `make restart` | Restart all services | `make restart` |
| `make restart-fast s=SERVICE` | Quick restart one service | `make restart-fast s=api-router` |
| `make rebuild s=SERVICE` | Rebuild one service | `make rebuild s=engine` |
| `make doctor` | Check environment health | `make doctor` |

### Doppler Secrets Management

| Command | Description | Example |
|---------|-------------|---------|
| `make doppler-dev` | Start with Doppler secrets | `make doppler-dev` |
| `make doppler-stop` | Stop Doppler environment | `make doppler-stop` |

### LocalStack (AWS Emulation)

| Command | Description | Example |
|---------|-------------|---------|
| `make localstack` | Start LocalStack Pro | `make localstack` |
| `make localstack-stop` | Stop LocalStack | `make localstack-stop` |

### Observability

| Command | Description | Example |
|---------|-------------|---------|
| `make obs` | Start with observability stack | `make obs` |

### Logging & Monitoring

| Command | Description | Example |
|---------|-------------|---------|
| `make logs` | View all logs | `make logs` |
| `make logs s=SERVICE` | View specific service logs | `make logs s=api-router` |
| `make status` | Check all services health | `make status` |

### Database Management

| Command | Description | Example |
|---------|-------------|---------|
| `make db` | Open PostgreSQL console | `make db` |
| `make db-reset` | Reset local database | `make db-reset` |
| `make aurora-sync` | Sync from Aurora (needs tunnel) | `make aurora-sync` |
| `make aurora-tunnel` | Create SSH tunnel to Aurora | `make aurora-tunnel` |

### Debugging

| Command | Description | Example |
|---------|-------------|---------|
| `make shell s=SERVICE` | Open shell in container | `make shell s=api-router` |
| `make env s=SERVICE` | Check environment variables | `make env s=engine` |

### Testing

| Command | Description | Example |
|---------|-------------|---------|
| `make test` | Run all tests | `make test` |
| `make test-service s=SERVICE` | Test specific service | `make test-service s=api-router` |

### Building

| Command | Description | Example |
|---------|-------------|---------|
| `make build` | Build all Docker images | `make build` |
| `make build-service s=SERVICE` | Build specific service | `make build-service s=engine` |

### Terraform Infrastructure

| Command | Description | Example |
|---------|-------------|---------|
| `make tf-init` | Initialize Terraform | `make tf-init` |
| `make tf-plan` | Run Terraform plan | `make tf-plan` |
| `make tf-apply` | Apply Terraform changes ‚ö†Ô∏è | `make tf-apply` |

### Cleanup

| Command | Description | Example |
|---------|-------------|---------|
| `make clean` | Remove all containers and volumes | `make clean` |
| `make prune` | Docker system prune (aggressive) | `make prune` |

### Help

| Command | Description | Example |
|---------|-------------|---------|
| `make help` | Show quick help | `make help` |
| `make help-all` | Show all commands | `make help-all` |

## üéØ Common Workflows

### Daily Development Start
```bash
make dev          # Start services
make dc            # Check environment health
make c             # View containers
make logs          # Watch logs
```

### Restart After Code Changes
```bash
# Quick restart (NEW!)
make rs s=lockedin    # Restart LockedIn app
make rs s=api         # Restart API router
make rs s=admin       # Restart admin dashboard

# Watch logs from start
make ll s=lockedin
```

### Fresh Environment
```bash
make clean        # Clean everything
make aurora-sync  # Sync database
make dev-fresh    # Start fresh
```

### Debug a Service
```bash
# New shortcuts:
make ll s=api-router     # Live logs
make dc                   # Health check
make c                    # View containers

# Classic commands:
make shell s=api-router    # Open shell
make env s=api-router      # Check env vars
```

### Rebuild After Dependencies
```bash
# New shortcut:
make rb s=lockedin      # Rebuild LockedIn

# Full command:
make rebuild s=lockedin
```

### Test Changes
```bash
make test-service s=api-router   # Run tests
make rb s=api-router             # Rebuild (new!)
```

### LocalStack Testing
```bash
make localstack   # Start LocalStack
make dev          # Start services
# Test AWS features
make localstack-stop  # Stop when done
```

## üì¶ Available Services

| Service | Port | Description |
|---------|------|-------------|
| `api-router` | 3001 | Express.js API Gateway |
| `engine` | 3030 | Temporal workflow engine |
| `dormway-crews` | 8000 | AI/ML crew service |
| `ably-relay` | 3032 | Real-time messaging |
| `syllabus-webviewer` | 3002 | Syllabus viewer |
| `test-harness` | 3003 | Testing UI |
| `postgres-local` | 5432 | PostgreSQL database |
| `redis-local` | 6379 | Redis cache |
| `pgadmin` | 8080 | Database admin UI |
| `nginx` | 80 | Reverse proxy |

## üé® Color Output

The Makefile uses color-coded output:
- üü¢ **Green**: Success messages
- üü° **Yellow**: Warnings or status
- üî¥ **Red**: Errors or stop actions
- ‚ö™ **White**: Normal output

## üí° Tips

1. **Tab completion**: The Makefile supports tab completion for targets
2. **Parallel execution**: Some commands can run in parallel with `-j`
3. **Dry run**: Use `make -n COMMAND` to see what would be executed
4. **Variables**: Override with `make dev DOPPLER_CONFIG=production`

## üîß Customization

### Environment Variables
```bash
# Use different Doppler config
DOPPLER_CONFIG=dev_riley make doppler-dev

# Use different docker-compose file
make logs s=api-router
```

### Adding New Commands

Edit `/Users/ekaplan/Development/GitHub/dormway-platform/Makefile`:

```makefile
my-command: ## Description here
	@echo "Running my command..."
	@docker-compose -f infrastructure/docker/docker-compose.local-dev.yml ...
```

## üìù Helper Scripts

Located in `/scripts/`:
- `dev-simple.sh` - Doppler startup script
- `dev-quick.sh` - Quick dev commands
- `copy-missing-services.sh` - Copy services for migration

## üö® Troubleshooting

### Services won't start
```bash
make clean        # Clean everything
make build        # Rebuild images
make dev          # Try again
```

### Port already in use
```bash
make down         # Stop containers
lsof -i :3001     # Check what's using port
make dev          # Start again
```

### Database issues
```bash
make db-reset     # Reset database
make aurora-sync  # Sync from Aurora
```

---

*Quick Reference for DormWay Platform Makefile*  
*Location: `/Users/ekaplan/Development/GitHub/dormway-platform/Makefile`*
