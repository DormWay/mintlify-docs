---
title: "Analytics Adapter"
description: "import { getAnalyticsAdapter } from '@dormway/core/adapters/analytics';"
---

# Analytics Adapter

## Overview

**Analytics Adapter** provides Amplitude integration for event tracking and user analytics.

**Purpose**: Centralized event tracking with user identification, properties, and batching support.

**Location**: `@dormway/core/adapters/analytics`

---

## Installation

```typescript
import { getAnalyticsAdapter } from '@dormway/core/adapters/analytics';

const analytics = getAnalyticsAdapter();
```

---

## Configuration

**Environment variables**:
- `AMPLITUDE_API_KEY` - Amplitude project API key

---

## Methods

### track

Track an event with properties.

**Signature**:
```typescript
track(userId: string, eventName: string, properties?: Record<string, any>): Promise<void>
```

**Example**:
```typescript
await analytics.track('user-123', 'dayplan_generated', {
  date: '2025-11-23',
  itemCount: 12,
  generationTimeMs: 1500,
});
```

---

### identify

Set user properties.

**Signature**:
```typescript
identify(userId: string, properties: Record<string, any>): Promise<void>
```

**Example**:
```typescript
await analytics.identify('user-123', {
  email: 'student@umich.edu',
  campus: 'University of Michigan',
  plan: 'premium',
  signupDate: '2025-11-01',
});
```

---

### batchTrack

Track multiple events efficiently.

**Signature**:
```typescript
batchTrack(events: Array<{ userId: string; eventName: string; properties?: Record<string, any> }>): Promise<void>
```

**Example**:
```typescript
await analytics.batchTrack([
  { userId: 'user-123', eventName: 'course_added', properties: { courseCode: 'CS 101' } },
  { userId: 'user-123', eventName: 'syllabus_uploaded', properties: { fileSize: 2048 } },
]);
```

---

### flush

Flush pending events.

**Signature**:
```typescript
flush(): Promise<void>
```

**Example**:
```typescript
// Before shutdown
await analytics.flush();
```

---

## Common Patterns

### Pattern 1: Track User Actions

```typescript
async function trackUserAction(userId: string, action: string, metadata: any) {
  await analytics.track(userId, action, {
    ...metadata,
    timestamp: new Date().toISOString(),
    source: 'web',
  });
}
```

---

### Pattern 2: Onboarding Funnel

```typescript
async function trackOnboardingStep(userId: string, step: string) {
  await analytics.track(userId, 'onboarding_step_completed', {
    step,
    stepNumber: getStepNumber(step),
  });
}
```

---

## Best Practices

### ✅ Do
- **Track meaningful events** (user actions, not system internals)
- **Use consistent naming** (`object_action` format)
- **Include context** in properties
- **Batch events** when tracking multiple
- **Flush on shutdown**

### ❌ Don't
- **Don't track PII** in properties
- **Don't track too frequently**
- **Don't use dynamic event names**
- **Don't forget to flush**

---

**Last Updated**: 2025-11-23
**Maintainer**: Platform Team
