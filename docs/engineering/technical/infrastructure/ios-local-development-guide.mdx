---
title: "iOS Local Development Guide"
description: "This guide covers how to run the local stack in `dormway-beta-workspace` and point `ios-clean` at it."
---

# iOS Local Development Guide

This guide covers how to run the local stack in `dormway-beta-workspace` and point `ios-clean` at it.

For the canonical system trace (auth, gateway headers, StudentWatcher, etc), see [How DormWay Works](/docs/engineering/architecture/how-dormway-works).

## 1) Start the local stack

From the workspace root:

```bash
make dev
make status
```

Common health checks:

- Zuplo: `http://localhost:9000/health` (if running)
- API Router: `http://localhost:3001/health`

## 2) Choose an API base URL

### Option A (recommended): Zuplo gateway

- Base URL: `http://localhost:9000`
- Why: mirrors gateway behavior (injects `gateway-api-key` + `x-user-*` headers via policies in `.repos/dormway-api-2`)

### Option B: direct to API Router

- Base URL: `http://localhost:3001`
- Why: faster backend debugging when you don’t need gateway policies
- Note: auth is still enforced; you’ll need a valid auth method (see [How DormWay Works](/docs/engineering/architecture/how-dormway-works) → Auth).

## 3) Auth expectations (current)

- iOS uses **Clerk** sessions and attaches a `Bearer` token (see `.repos/ios-clean/Core/Services/AuthService.swift`).
- Some requests may be signed with app-level HMAC (see `.repos/ios-clean/Core/Security/AppHMACSigner.swift`); backend verifier: `.repos/dormway-platform/services/api-router/src/middleware/app-hmac-v2.ts`.

## 4) Physical device notes

If testing on a physical iPhone on the same network:

- Use your Mac’s LAN IP instead of `localhost` (e.g. `http://192.168.x.y:9000`)
- Ensure macOS firewall allows inbound connections to the chosen port(s)
- Keep ATS exceptions for local HTTP in `Info.plist` if needed
