---
title: "README"
description: "This package contains the complete visual design system, campaign architecture, and implementation plan for DormWay's Customer.io email communication platfor..."
---

# DormWay Customer.io Email Campaign System - Complete Deliverable Package

## âš ï¸ **IMPORTANT UPDATE: Liquid Template System**

**We've moved away from Customer.io's EMC component system** to standard liquid templates for better email client compatibility and consistency with the dormway-lockedin design system.

**New Files:**
- ğŸ“„ `customerio-liquid-base-template.html` - Base layout with header/footer
- ğŸ“š `liquid-snippets-library.md` - Reusable HTML/Liquid snippets (copy-paste templates)
- ğŸ“‹ `customerio-component-plan.md` - Updated implementation guide
- ğŸ“§ `example-welcome-email-liquid.html` - Complete example using new system
- â­ `CUSTOMER-IO-BEST-PRACTICES.md` - **START HERE** - Complete guide to Customer.io constraints
- ğŸ” `AMPLITUDE_ATTRIBUTES_ANALYSIS.md` - **CRITICAL** - User property requirements for email campaigns

**Key Changes:**
- âœ… Better email client compatibility (table-based layouts)
- âœ… Matches dormway-lockedin design (glassmorphic effects, purple/pink/orange gradient)
- âœ… Dark-first design (#0f111c background instead of #1a1a1a)
- âœ… Full control over styling with inline CSS
- âœ… Easier to debug and maintain

---

## Overview

This package contains the complete visual design system, campaign architecture, and implementation plan for DormWay's Customer.io email communication platform. All designs follow the DormWay design system with **dark-first theming** matching dormway-lockedin.

---

## Deliverables Summary

### 1. Campaign Flow Diagrams
**File:** `customerio-campaign-flows.mermaid`

Visual flow diagram showing all email campaigns and their triggers, including:
- Welcome/onboarding sequence (4 emails)
- Syllabus processing flows (success, failed, milestones)
- Engagement campaigns (weekly digest, re-engagement)
- Milestone achievements (power user, finals week)
- Push notification integration points

**Format:** Mermaid diagram (can be rendered on GitHub, in VS Code, or at mermaid.live)

---

### 2. User Journey Timeline
**File:** `user-journey-timeline.mermaid`

Comprehensive timeline showing every email and push touchpoint from Day 0 (signup) through ongoing engagement, with:
- Exact timing for each communication (Day 2, Day 4, Day 7, etc.)
- Behavioral triggers and conditions
- Milestone events
- Academic season triggers (finals, midterms)

**Format:** Mermaid timeline diagram

---

### 3. Liquid Template Base Layout (NEW)
**File:** `customerio-liquid-base-template.html`

Production-ready base layout template for Customer.io featuring:
- **Dark-first design** matching dormway-lockedin (#0f111c background)
- **Glassmorphic effects** with gradient background overlay
- **Table-based layout** for maximum email client compatibility
- **Gradient brand logo** (purple â†’ pink â†’ orange)
- **Social media footer** with icons
- **Legal footer** with unsubscribe/preferences links
- **Responsive breakpoints** for mobile optimization
- Content insertion via `{{{ content }}}` placeholder

Upload this file to Customer.io (Content â†’ Layouts) and set as default for all DormWay campaigns.

---

### 4. Liquid Snippets Library (NEW)
**File:** `liquid-snippets-library.md`

Comprehensive library of reusable HTML/Liquid snippets including:
- **Hero sections** (gradient, glass effect)
- **Content cards** (glass card, accent border)
- **Buttons & CTAs** (primary, secondary, text link)
- **Stats grids** (3-column responsive layout)
- **Lists** (assignments, courses, steps)
- **Dividers** (simple, gradient)
- **Color reference** from dormway-lockedin

All snippets use table-based layouts with inline CSS for maximum compatibility.

---

### 5. Amplitude Attributes Analysis (NEW - CRITICAL)
**File:** `AMPLITUDE_ATTRIBUTES_ANALYSIS.md`

**âš ï¸ CRITICAL FOR EMAIL CAMPAIGNS**

Comprehensive analysis of Amplitude user properties required for Customer.io conditional triggers:
- **User Property Requirements:** 20+ properties needed for email campaign conditions
- **Implementation Gaps:** Identifies missing boolean flags and cumulative counters
- **Current Status:** Events are tracked âœ…, but user properties are not being set âŒ
- **Priority Breakdown:** P0-P3 classification for implementation
- **Code Examples:** Exact implementation needed in syllabusProcessor, studentProcessor workflows
- **Testing Plan:** Verification steps for Amplitude â†’ Customer.io integration

**Key Finding**: We're tracking events but NOT setting corresponding user properties, which blocks Customer.io conditional triggers like `if first_syllabus_uploaded = false`.

---

### 6. Visual Design System Documentation
**File:** `email-visual-design-system.md`

Complete design specification including:
- **Brand Colors:** Full palette with usage guidelines
- **Typography System:** Headers, body text, captions with exact sizes
- **Button Styles:** Primary, secondary, tertiary with hover states
- **Card Components:** Standard cards, stat cards, course cards with layouts
- **Icon System:** 24px standard icons with semantic meanings
- **Email Layout Structure:** Header (80px), Hero (200px), Content (variable), Footer (120px)
- **Responsive Breakpoints:** Desktop (600px+) and mobile (<600px) specifications
- **Accessibility Requirements:** WCAG AA contrast ratios, touch targets, semantic HTML
- **Template Sections Library:** Reusable HTML components ready to copy/paste

**Key Specifications:**
- Max email width: 600px
- Background: #1a1a1a (near black)
- Primary brand: #795cf0 (purple)
- Accent: #ff8e4d (orange)
- Success: #10b981 (green)
- Error: #ef4444 (red)
- Card background: #2a2a2a
- Body text: 16px / #f5f5f5
- Headers: 32px / 700 / #ffffff

---

### 6. Email Template: Welcome (Liquid Version - NEW)
**File:** `example-welcome-email-liquid.html`

Complete example email using the new liquid template system featuring:
- Uses base layout template
- Gradient hero section
- 3-step onboarding list with numbered badges
- Primary CTA button
- Social proof banner
- All inline CSS for email client compatibility

**Template Variables:**
- `{{first_name}}`
- `{{campus_name}}`
- `{{campus_student_count}}`

This example demonstrates how to compose emails using the liquid snippets library.

---

### 7. Email Template: Welcome (Legacy HTML)
**File:** `email-template-welcome.html`

Production-ready HTML email template for the welcome sequence featuring:
- Gradient purple hero section with celebration emoji
- 3-step getting started guide with numbered circles
- Primary CTA button (Complete Your Profile)
- Social proof banner with dynamic student count
- Fully responsive design
- Dark mode optimized
- Inline CSS for email client compatibility

**Template Variables:**
- `{{first_name}}`
- `{{campus_name}}`
- `{{student_count}}`
- `{{preferences_url}}`
- `{{unsubscribe_url}}`

**Customer.io Template ID:** `welcome-to-dormway`

---

### 8. Email Template: Syllabus Success (Legacy HTML)
**File:** `email-template-syllabus-success.html`

Production-ready HTML template for successful syllabus processing with:
- Green gradient success hero with checkmark icon
- 3-column stats card (Assignments, Events Created, AI Processing)
- Detailed course card with schedule, location, instructor, section badge
- Upcoming assignments list with priority badges
- Pro tip callout box
- Responsive stat grid (stacks on mobile)

**Template Variables:**
- `{{first_name}}`
- `{{course_name}}`
- `{{course_code}}`
- `{{assignment_count}}`
- `{{event_count}}`
- `{{schedule}}`
- `{{location}}`
- `{{instructor_name}}`
- `{{section}}`
- `{{assignment_1_name}}`, `{{assignment_1_date}}` (and 2, 3...)

**Customer.io Template ID:** `syllabus-processed` (already deployed âœ…)

---

### 9. Email Template: Weekly Digest (Legacy HTML)
**File:** `email-template-weekly-digest.html`

Production-ready HTML template for weekly personalized digest including:
- Purple gradient hero with week date badge
- High priority deadlines section with color-coded badges (red = high, amber = medium)
- Schedule summary with 3-stat grid (Classes, Free Hours, Study Blocks)
- AI-powered recommendation card with brain icon
- Campus events list with emoji icons
- Adjust preferences link in CTA section
- Fully responsive (stats grid stacks on mobile)

**Template Variables:**
- `{{week_start_date}}`
- `{{campus_name}}`
- `{{semester_name}}`
- `{{course_code_1}}`, `{{assignment_1_name}}`, `{{assignment_1_date}}` (and 2...)
- `{{class_count}}`, `{{free_hours}}`, `{{study_blocks}}`
- `{{optimal_study_time_1}}` (and 2, 3)
- `{{ai_recommendation}}`
- `{{event_1_name}}`, `{{event_1_date}}`, `{{event_1_time}}` (and 2...)

**Customer.io Template ID:** `weekly-digest`
**Trigger:** Every Monday 8am local time (if `weekly_digest = true`)

---

### 10. Campaign Architecture Diagram
**File:** `campaign-architecture-diagram.mermaid`

System architecture diagram showing:
- **Data Sources:** iOS app, TypeScript API, Temporal workflows, PostgreSQL
- **Customer.io Platform:** CDP, segments, campaigns, templates, analytics
- **Event Tracking:** All 9 core events (user_created, syllabus_uploaded, etc.)
- **Campaign Types:** 6 major email series + 4 push notification types
- **User Preferences:** Database schema, UI components, sync flows
- **Delivery & Monitoring:** Email delivery, push delivery, webhooks, Slack alerts
- **Data Flow:** Visual connections showing how data moves through the system

**Color Coding:**
- Purple (#795cf0): Core Customer.io platform
- Orange (#ff8e4d): Campaign engine
- Green (#10b981): Successful delivery paths
- Red (#ef4444): Re-engagement flows
- Blue (#3b82f6): Preferences system

---

### 11. Updated Implementation Guide (NEW)
**File:** `customerio-component-plan.md`

**Replaces EMC component system** with liquid template approach including:
- Design system tokens from dormway-lockedin
- Base layout setup instructions
- Reusable snippet catalog
- Template mapping guide
- Updated implementation checklist
- Migration rationale (why we moved away from EMC)

**Key sections:**
1. Design system colors and tokens
2. Base layout setup
3. Liquid snippets overview
4. Template composition examples
5. Implementation checklist
6. Migration notes from EMC

---

### 12. Implementation Checklist (Legacy)
**File:** `implementation-checklist.md`

12-week phased implementation plan with 180+ checkboxes covering:

**Phase 1 (Week 1):** Foundation - Database setup, SDK integration, infrastructure
**Phase 2 (Week 2):** Welcome series - 4 emails + push notifications
**Phase 3 (Week 3):** Syllabus processing series - Success, failed, milestones
**Phase 4 (Week 4):** Engagement campaigns - Weekly digest, feature tutorials
**Phase 5 (Week 5):** Milestone emails - Achievements, finals support
**Phase 6 (Week 6):** Transactional hooks - Password reset, account deletion
**Phase 7 (Week 7):** UI implementation - iOS preferences, web center
**Phase 8 (Week 8):** Testing & QA - Cross-client, responsive, accessibility
**Phase 9 (Week 9):** Analytics & monitoring - Dashboards, alerts
**Phase 10 (Week 10):** Compliance - GDPR, CAN-SPAM, FERPA
**Phase 11 (Week 11):** A/B testing strategy - Subject lines, timing, content
**Phase 12 (Week 12):** Launch preparation - Soft launch, full launch

**Success Metrics Defined:**
- Welcome series: >45% open rate, >15% click rate
- Syllabus processing: >70% open rate (transactional)
- Weekly digest: >35% open rate, <2% unsubscribe rate
- Business impact: 80% first syllabus within 7 days, 70% retention at 30 days

**Post-Launch:** Weekly performance reviews, monthly content refresh, quarterly strategy review

---

## Email Campaign Summary

### Total Campaigns: 19 Email Templates + 4 Push Types

#### Welcome & Onboarding (4 emails)
1. **Welcome Email** - Immediate (transactional) âœ… Template ready
2. **Upload Syllabus** - Day 2 (conditional)
3. **Connect Calendar** - Day 4 (conditional)
4. **Dormant Re-engagement** - Day 7 (conditional)

#### Syllabus Processing (4 emails)
5. **Syllabus Success** - Immediate (transactional) âœ… Already deployed + Template ready
6. **Processing Failed** - Immediate (transactional)
7. **First Syllabus Milestone** - Immediate (behavioral)
8. **All Syllabi Complete** - Immediate (behavioral)

#### Engagement & Retention (6 emails)
9. **Weekly Digest** - Every Monday 8am âœ… Template ready
10. **Daily Plan** - Every day 6am (optional) âœ… Template ready
11. **BrainGains Tutorial** - Day 10 (feature adoption)
12. **7-Day Inactivity** - 7 days (re-engagement)
13. **10-Day Push** - 10 days (re-engagement)
14. **14-Day Final** - 14 days (re-engagement)

#### Milestones & Events (3 emails)
14. **Power User Achievement** - Behavioral trigger
15. **Finals Week Support** - AI-detected
16. **Midterm Motivation** - AI-detected

#### Transactional (3 emails)
17. **Password Reset** - User-initiated
18. **Account Deletion** - User-initiated
19. **Data Export Ready** - User-initiated

#### Push Notifications (4 types)
- Permission primers (Day 2)
- Syllabus processing updates (immediate)
- Deadline reminders (1 week, 3 days, 1 day, 3 hours before)
- Re-engagement nudges (Day 10, feature-specific)

---

## Design System Integration

All email templates are built using the DormWay Design System:

### Core Design Tokens Used:
- `DS.Color.Palette.Brand.primary` (#795cf0)
- `DS.Color.Palette.Brand.secondaryAccent` (#ff8e4d)
- `DS.Color.Palette.Neutral.nearBlack` (#1a1a1a)
- `DS.Color.Palette.Neutral.grey900` (#2a2a2a)
- `DS.Color.Palette.State.success` (#10b981)
- `DS.Color.Palette.State.error` (#ef4444)
- `DS.Typography.displayLarge` (32px / 700)
- `DS.Typography.body` (16px / 400 / 1.6 line-height)
- `DS.Spacing.standard` (16px)
- `DS.Radius.medium` (8px)

### Email-Safe Implementation:
Since email clients don't support CSS variables or external stylesheets, all design tokens are converted to inline CSS with hex color values. The templates maintain visual consistency with the iOS app while being optimized for email rendering.

---

## Technical Integration Points

### Database Schema Required:
```sql
CREATE TABLE communication_preferences (
  user_id UUID REFERENCES accounts(id),
  marketing_emails BOOLEAN DEFAULT true,
  product_updates BOOLEAN DEFAULT true,
  weekly_digest BOOLEAN DEFAULT true,
  push_notifications BOOLEAN DEFAULT true,
  sms_notifications BOOLEAN DEFAULT false,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### Customer.io SDK Integration (iOS):
```swift
// Initialize
CustomerIO.initialize(siteId: "YOUR_SITE_ID", 
                      apiKey: "YOUR_API_KEY", 
                      region: .US)

// Identify user
CustomerIO.shared.identify(userId: user.id, traits: [
    "email": user.email,
    "campus": user.campus.name,
    "campusId": user.campus.id
])

// Track events
CustomerIO.shared.track(name: "user_created", properties: [:])
CustomerIO.shared.track(name: "syllabus_uploaded", properties: [
    "courseCode": course.code,
    "assignmentCount": assignments.count
])

// Register device token for push
CustomerIO.shared.registerDeviceToken(deviceToken)
```

### API Event Tracking (TypeScript):
```typescript
import { CustomerIO } from 'customerio-node';

const cio = new CustomerIO(
  process.env.CUSTOMER_IO_SITE_ID,
  process.env.CUSTOMER_IO_API_KEY
);

// Send transactional email
await cio.sendEmail({
  transactional_message_id: 'syllabus-processed',
  to: user.email,
  identifiers: { id: user.id },
  message_data: {
    firstName: user.firstName,
    courseName: course.name,
    assignmentCount: assignments.length
  }
});

// Track event
await cio.track(user.id, {
  name: 'power_user_achieved',
  data: {
    engagementScore: score,
    percentile: percentile
  }
});
```

### Temporal Workflow Integration:
Already implemented in `customerio-email.activities.ts` for syllabus processing. Extend pattern for other workflows:
```typescript
import { sendCustomerIOTransactionalEmail } from './customerio-email.activities';

// In workflow
await sendCustomerIOTransactionalEmail({
  userId: user.id,
  transactionalId: 'finals-week-support',
  data: {
    firstName: user.firstName,
    examCount: exams.length,
    firstExamDate: exams[0].date
  }
});
```

---

## Key Features

### Personalization Engine
All emails support dynamic content based on:
- **User Attributes:** Name, campus, major, year
- **Behavioral Data:** App usage, feature activation, engagement score
- **Academic Context:** Course load, semester phase, deadline density
- **LLM Traits:** Learning style, stress indicators, time management patterns
- **Campus Data:** Student count, local events, resources

### Segmentation Strategy
Customer.io segments enable targeted campaigns:
- **New Users** (< 7 days): Onboarding sequence
- **Active Users** (opens app weekly): Weekly digest
- **Dormant Users** (> 7 days inactive): Re-engagement
- **Power Users** (high engagement score): Achievement emails
- **Finals Week** (AI-detected): Support resources
- **Campus-Specific:** Local events, resources

### Omnichannel Coordination
Email + Push work together:
- **Syllabus Upload Flow:** Push (processing) â†’ Push (complete) â†’ Email (detailed results)
- **Re-engagement Flow:** Email (Day 7) â†’ Push (Day 10) â†’ Email (Day 14)
- **Weekly Digest:** Email (Monday 8am) â†’ Push (if not opened in 24h)

---

## Compliance & Privacy

### GDPR Compliance
- Explicit opt-in during onboarding
- Granular preference controls (marketing, product updates, digest)
- One-click unsubscribe in all emails
- Web-based preference center
- Data deletion on account termination

### CAN-SPAM Compliance
- Physical address in footer
- Clear sender identification
- Accurate subject lines
- Unsubscribe processed within 10 days
- No deceptive content

### FERPA Compliance
- No PII in URLs or tracking pixels
- Educational records handled per FERPA requirements
- On-device processing when possible
- Secure data transmission (TLS 1.2+)
- Customer.io DPA in place

---

## Next Steps

1. **Review all deliverables** in this package
2. **Prioritize Phase 1** infrastructure setup (Week 1)
3. **Design approval** for 3 HTML templates (Welcome, Syllabus Success, Weekly Digest)
4. **Stakeholder sign-off** on implementation timeline
5. **Assign engineering resources** for 12-week implementation
6. **Schedule design reviews** for remaining 15 email templates
7. **Begin Customer.io configuration** (templates, segments, campaigns)

---

## File Manifest

```
docs/email-journey/
â”œâ”€â”€ ğŸ†• â­ CUSTOMER-IO-BEST-PRACTICES.md           # NEW: START HERE - Complete guide
â”œâ”€â”€ ğŸ†• customerio-liquid-base-template.html       # NEW: Base layout for all emails
â”œâ”€â”€ ğŸ†• liquid-snippets-library.md                 # NEW: HTML templates to copy-paste
â”œâ”€â”€ ğŸ†• customerio-component-plan.md               # NEW: Updated implementation guide
â”œâ”€â”€ ğŸ†• example-welcome-email-liquid.html          # NEW: Complete working example
â”œâ”€â”€ customerio-campaign-flows.mermaid             # Campaign flow diagram
â”œâ”€â”€ user-journey-timeline.mermaid                 # User journey timeline
â”œâ”€â”€ email-visual-design-system.md                 # Complete design specs (legacy)
â”œâ”€â”€ email-template-welcome.html                   # Welcome email (legacy HTML)
â”œâ”€â”€ email-template-syllabus-success.html          # Syllabus success (legacy HTML)
â”œâ”€â”€ email-template-weekly-digest.html             # Weekly digest (legacy HTML)
â”œâ”€â”€ email-template-daily-plan.html                # Daily plan (legacy HTML)
â”œâ”€â”€ campaign-architecture-diagram.mermaid         # System architecture
â”œâ”€â”€ implementation-checklist.md                   # 12-week implementation plan (legacy)
â”œâ”€â”€ ICON-UPDATE-SUMMARY.md                        # Professional icons documentation
â””â”€â”€ README.md                                     # This document
```

---

## Support & Documentation

- **Customer.io Docs:** https://customer.io/docs/
- **DormWay Design System:** DormWay Design System
- **Project Knowledge:** See project notes for detailed context
- **Questions:** Contact engineering team via Slack #email-campaigns

---

**Last Updated:** September 30, 2025
**Version:** 2.0 (Liquid Template System)
**Status:** Ready for Implementation

---

## Migration Guide: EMC â†’ Liquid Templates

### Why We Changed
Customer.io's EMC (Email Markup Composer) component system had compatibility issues:
- Limited email client support (especially Outlook)
- Inconsistent rendering across platforms
- Complex debugging process
- Restricted customization options

### New Approach Benefits
âœ… **Better compatibility** - Table-based layouts work in all email clients
âœ… **Design consistency** - Matches dormway-lockedin exactly
âœ… **Full control** - Inline CSS for precise styling
âœ… **Easier maintenance** - Standard HTML/Liquid templates
âœ… **Proven patterns** - Industry-standard email development

### Quick Start
1. Upload `customerio-liquid-base-template.html` to Customer.io as a layout
2. Set as default for DormWay campaigns
3. **Copy HTML directly** from `liquid-snippets-library.md` into message body (don't use Customer.io snippets!)
4. Replace placeholder text with Customer.io attributes:
   - Customer data: `{{customer.first_name}}`, `{{customer.campus_name}}`
   - Event data: `{{event.course_name}}`, `{{event.assignments}}`
   - Built-in: `{{unsubscribe_url}}`, `{{preferences_url}}`
5. Preview and test in multiple email clients

âš ï¸ **Important**: Customer.io snippets cannot reference message body variables. Always paste HTML directly!

See `customerio-component-plan.md` for detailed implementation steps.
