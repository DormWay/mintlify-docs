---
title: "Admin PLG Endpoints"
description: "Reference for PLG admin APIs used by Spot Check and Campus Linker."
---

# Admin PLG Endpoints

Reference for PLG admin APIs used by Spot Check and Campus Linker.

## Spot Check
- GET `/api/admin/plg/spotcheck`
  - Query: `status=provisional|all`, `domain`, `limit`
  - Returns: users + counts, campus inference.

## Cleanup Batch
- POST `/api/admin/plg/cleanup-batch`
  - Body: `{ status?, domain?, limit?, preferredCampusId?, dryRun? }`
  - Behavior:
    - Consolidate student contexts (optionally create when missing).
    - Merge duplicates; set campus link via dependencies/syllabi.
    - `dryRun=true`: compute only; includes `dryRun` and per-user summary.

## Reassign Syllabi
- POST `/api/admin/plg/reassign-syllabi`
  - Body: `{ userId?|email?|serviceDataIds?, campusId, dryRun? }`
  - Moves matching syllabi to course contexts under campus.
  - Reuses course by `external_id=course:CODE`; creates if needed (unless `dryRun`).

## Reassign One
- POST `/api/admin/plg/reassign-one`
  - Body: `{ serviceDataId, campusId, dryRun? }`
  - Derives course code/name from service_data/context/filename.
  - `dryRun=true`: returns `{ inferred: { code,name,externalId }, wouldCreateCourse, existingCourseId }`.

## Deduplication
- Courses: `contexts.type='course'` unique by `(parent_id, external_id)` usage.
- Universities: when creating from registry, reuse `contexts` row with `metadata->>'registry_id'`.

*Last updated: 2025-09-13*
