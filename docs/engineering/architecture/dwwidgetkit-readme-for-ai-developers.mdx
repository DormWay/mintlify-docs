---
title: "DWWidgetKit   README for AI Developers"
description: "1. âœ… Read the 3 essential guides (90 min) 2. âœ… Explore existing widget code in `.repos/ios-clean/Packages/DWWidgetKit/` 3. âœ… Review DWDesign package in `.rep..."
---

# DWWidgetKit - README for AI Developers

**Welcome!** This document is your starting point for implementing DormWay iOS widgets. It explains what to read, in what order, and why.

---

## ğŸ¯ Quick Start (3-Step Process)

### Step 1: Understand WHY (15 min read)
**Read:** [DWWidgetKit - Context Guide for AI Developers](/docs/engineering/architecture/dwwidgetkit-context-guide-for-ai-developers)

**What you'll learn:**
- What is DormWay and who are the users?
- Why do widgets matter for daily engagement?
- What are the 5 core user journeys (beta scope)?
- How do widgets fit into the product vision?
- What's the overall platform architecture?

**Why read this first:** You need to understand the product context to make good implementation decisions. Without this, you'll build features that don't serve users.

---

### Step 2: Learn iOS Patterns (30 min read)
**Read:** [DWWidgetKit - iOS Architecture & Design System Guide](/docs/engineering/architecture/dwwidgetkit-ios-architecture-design-system-guide)

**What you'll learn:**
- Swift 6.0 concurrency patterns (@MainActor, async/await)
- DWDesign system (typography, colors, spacing, radius tokens)
- How to build widget views correctly
- Widget size guidelines (systemSmall, systemMedium)
- Error, loading, and empty states
- Accessibility and testing patterns

**Why read this second:** You need to know how to write iOS code the DormWay way. This guide contains all the good patterns extracted from the original prompt.

---

### Step 3: Integrate with Backend (45 min read + implementation)
**Read:** [DWWidgetKit - Backend Integration Guide](/docs/engineering/architecture/dwwidgetkit-backend-integration-guide)

**What you'll learn:**
- Actual backend API (composite endpoint)
- Authentication (device key vs JWT)
- Real-time updates (Ably integration)
- Data models (widget envelope pattern)
- Caching strategy (ETag-based)
- Context system (hierarchical filtering)
- Complete implementation examples

**Why read this third:** Now you understand WHY and HOW, you can connect to real backend data. This guide is verified against actual backend implementation (as of 2025-11-06).

---

## ğŸ“š Complete Reading Order

### Essential (Must Read)

| # | Document | Time | Purpose |
|---|----------|------|---------|
| 1 | [DWWidgetKit - Context Guide for AI Developers](/docs/engineering/architecture/dwwidgetkit-context-guide-for-ai-developers) | 15 min | Product vision, user needs, architecture |
| 2 | [DWWidgetKit - iOS Architecture & Design System Guide](/docs/engineering/architecture/dwwidgetkit-ios-architecture-design-system-guide) | 30 min | Swift patterns, DWDesign, UI/UX |
| 3 | [DWWidgetKit - Backend Integration Guide](/docs/engineering/architecture/dwwidgetkit-backend-integration-guide) | 45 min | API integration, real-time, caching |

**Total Essential Reading: ~90 minutes**

---

### Supplemental (Helpful Context)

| Document | Location | Purpose |
|----------|----------|---------|
| **DormWay Platform - Comprehensive Guide** | `.workspace/current-state/architecture/DORMWAY_COMPREHENSIVE_GUIDE.md` | Full platform architecture, all services |
| **DormWay Product Overview** | `obsidian-vault/DormWay/Plans/Planning/DormWay Product Overview.md` | Product vision, roadmap, differentiators |
| **5 Core User Journeys** | `obsidian-vault/DormWay/Product/Features/5 Core User Journeys/README.md` | Beta scope (line is snapped) |
| **WIDGET_API_GUIDE.md** | Workspace root | Complete backend API reference (25KB) |
| **WIDGET_IMPLEMENTATION_OVERVIEW.md** | `.repos/ios-clean/` | Current iOS widget implementation |
| **REALTIME_ABLY_SPECIFICATION.md** | `obsidian-vault/DormWay/Product/Beta/` | Real-time architecture details |

---

## ğŸš€ Implementation Workflow

### Phase 1: Setup & Understanding (Day 1)
1. âœ… Read the 3 essential guides (90 min)
2. âœ… Explore existing widget code in `.repos/ios-clean/Packages/DWWidgetKit/`
3. âœ… Review DWDesign package in `.repos/ios-clean/Packages/DWDesign/`
4. âœ… Test existing widgets on device/simulator

### Phase 2: Backend Integration (Days 2-3)
1. âœ… Update `WidgetDataProvider` to use composite API
2. âœ… Implement device key authentication
3. âœ… Add ETag-based caching
4. âœ… Test with real backend endpoint
5. âœ… Remove any mock data fallbacks

### Phase 3: Enhance Existing Widgets (Days 4-5)
1. âœ… Update Ace widget to use real data
2. âœ… Update Next Action widget to use real data
3. âœ… Polish UI with DWDesign tokens
4. âœ… Add proper loading and error states
5. âœ… Test on physical device

### Phase 4: Add New Widgets (Days 6-8)
1. âœ… Implement Schedule widget
2. âœ… Implement Assignments widget
3. âœ… Implement Academic Momentum widget (optional)
4. âœ… Implement Study Blocks widget (optional)
5. âœ… Add all to WidgetBundle

### Phase 5: Real-Time & Polish (Days 9-10)
1. âœ… Integrate Ably for push updates
2. âœ… Implement context awareness
3. âœ… Add comprehensive error handling
4. âœ… Write unit tests
5. âœ… Test on physical devices

---

## âš ï¸ Critical Rules (Don't Break These!)

### 1. DWDesign is LAW
- âŒ **NEVER** hardcode fonts, colors, spacing, or radius
- âœ… **ALWAYS** use `DS.Typography.*`, `DS.Color.Semantic.*`, `DS.Spacing.*`, `DS.Radius.*`
- If you type a number for styling, STOP and find the token!

### 2. Use REAL Backend Data
- âŒ **NO MOCK DATA** in production code
- âœ… Use `GET /dashboard/v1/composite` endpoint
- Return errors if backend unavailable, don't fake data

### 3. Respect Beta Scope
- âœ… Focus on 5 core user journeys
- âŒ Don't build features not in beta scope (study groups, dining, transportation, etc.)
- The line is snapped (locked July 12, 2025)

### 4. Privacy First
- âœ… Consent defaults to FALSE
- âœ… No sensitive info on lock screen (widgets visible to others)
- âœ… Respect user privacy settings

### 5. Context-Aware
- âœ… Use current context from App Groups
- âœ… Pass context parameter to API
- âœ… Show relevant data for time/location/user

### 6. Swift 6.0 Concurrency
- âœ… Use `@MainActor` for UI code
- âœ… Use `async/await` for network calls
- âŒ NO `@MainActor` on TimelineProvider

---

## ğŸ¨ Widget Design Principles

### What Makes a Good Widget?

1. **Glanceable** - Information visible in <5 seconds, no scrolling
2. **Actionable** - Clear next step ("Study for CS 101 midterm")
3. **Contextual** - Shows relevant info for current time/location
4. **Minimal** - Only most important information
5. **Consistent** - Uses DWDesign system
6. **Privacy-respecting** - No sensitive data visible to others

### Widget Priority (Build These First)

| Priority | Widget | Why |
|----------|--------|-----|
| **P0** | Next Action | "What should I do right now?" - Core engagement |
| **P0** | Ace Recommendation | AI study suggestion - Unique differentiator |
| **P0** | Schedule | "When's my next class?" - Essential utility |
| **P1** | Assignments | "What's due this week?" - Academic tracking |
| **P2** | Academic Momentum | Weekly progress - Retention/gamification |
| **P2** | Study Blocks | Optimal study times - AI-powered scheduling |

---

## ğŸ“Š Widget User Experience

### The Daily Return User Scenario

**Morning (7:00 AM):**
- Student wakes up, checks phone
- **Next Action widget**: "Review CS 101 notes before class"
- **Schedule widget**: "CS 101 Lecture at 9:00 AM (in 2 hours)"
- **Weather widget**: "Rainy, 50Â°F - Bring umbrella"

**Between Classes (10:30 AM):**
- Standing in line for coffee
- **Ace widget**: "Study for ECON 201 midterm (in 2 days) - Focus Chapter 5"
- **Assignments widget**: "3 assignments due this week"

**Evening (8:00 PM):**
- Deciding what to study
- **Study Blocks widget**: "Deep focus study: 8:00-10:00 PM"
- **Academic Momentum widget**: "5-day study streak ğŸ”¥ Keep it up!"

**Without widgets:** Student would need to open app 6+ times
**With widgets:** Student glances at home screen, no app opening needed

**This is the magic of widgets.**

---

## ğŸ› ï¸ Key Files & Locations

### iOS Implementation

```
.repos/ios-clean/
â”œâ”€â”€ Packages/DWWidgetKit/
â”‚   â”œâ”€â”€ Sources/DWWidgetKit/
â”‚   â”‚   â”œâ”€â”€ Models/
â”‚   â”‚   â”‚   â””â”€â”€ WidgetModels.swift
â”‚   â”‚   â”œâ”€â”€ Provider/
â”‚   â”‚   â”‚   â””â”€â”€ WidgetDataProvider.swift  â† You'll modify this
â”‚   â”‚   â”œâ”€â”€ Shared/
â”‚   â”‚   â”‚   â””â”€â”€ WidgetExtensions.swift
â”‚   â”‚   â””â”€â”€ Widgets/
â”‚   â”‚       â”œâ”€â”€ AceStudyCommandWidget.swift
â”‚   â”‚       â”œâ”€â”€ NextActionWidget.swift
â”‚   â”‚       â””â”€â”€ [New widgets here]
â”‚   â””â”€â”€ Package.swift
â”‚
â”œâ”€â”€ Packages/DWDesign/
â”‚   â””â”€â”€ Sources/DWDesign/
â”‚       â”œâ”€â”€ Foundations/
â”‚       â”‚   â”œâ”€â”€ Typography.swift  â† Font tokens
â”‚       â”‚   â”œâ”€â”€ Colors.swift      â† Color tokens
â”‚       â”‚   â”œâ”€â”€ Spacing.swift     â† Spacing tokens
â”‚       â”‚   â””â”€â”€ Radius.swift      â† Corner radius tokens
â”‚       â””â”€â”€ Components/
â”‚
â”œâ”€â”€ DormWayWidgets/
â”‚   â”œâ”€â”€ DormWayWidgets.swift  â† Widget bundle entry point
â”‚   â”œâ”€â”€ Info.plist
â”‚   â””â”€â”€ DormWayWidgets.entitlements
â”‚
â””â”€â”€ Core/DependencyInjection/
    â””â”€â”€ Container.swift  â† Lines 505-515 (widget DI setup)
```

### Backend Implementation

```
.repos/dormway-platform/
â””â”€â”€ services/api-router/src/
    â”œâ”€â”€ routes/
    â”‚   â””â”€â”€ dashboard-routes.ts  â† Composite API endpoint
    â”œâ”€â”€ middleware/
    â”‚   â””â”€â”€ auth.ts  â† Authentication chain (device key)
    â””â”€â”€ services/
        â”œâ”€â”€ ably-service.ts  â† Real-time pub/sub
        â””â”€â”€ dashboard-composite-transformer.ts  â† Widget assembly
```

### Documentation

```
obsidian-vault/DormWay/Engineering/Architecture/
â”œâ”€â”€ DWWidgetKit - README for AI Developers.md  â† You are here!
â”œâ”€â”€ DWWidgetKit - Context Guide for AI Developers.md  â† Read first
â”œâ”€â”€ DWWidgetKit - iOS Architecture & Design System Guide.md  â† Read second
â””â”€â”€ DWWidgetKit - Backend Integration Guide.md  â† Read third

.workspace/
â”œâ”€â”€ current-state/
â”‚   â”œâ”€â”€ architecture/
â”‚   â”‚   â””â”€â”€ DORMWAY_COMPREHENSIVE_GUIDE.md  â† Platform overview
â”‚   â””â”€â”€ beta-specs/
â”‚       â”œâ”€â”€ WIDGET_DATA_FORMATS.md
â”‚       â”œâ”€â”€ REALTIME_ABLY_SPECIFICATION.md
â”‚       â””â”€â”€ BACKEND_REQUIREMENTS_FOR_BETA.md
â””â”€â”€ analysis/
    â””â”€â”€ WIDGET_PROMPT_AUDIT.md  â† Why original prompt was wrong
```

---

## ğŸ“ Learning Resources

### Explore Existing Code

**Good patterns to study:**
1. `Packages/DWDesign/Sources/DWDesign/Foundations/` - Design tokens
2. `Packages/DWWidgetKit/Sources/DWWidgetKit/Widgets/NextActionWidget.swift` - Complete widget example
3. `Core/DependencyInjection/Container.swift` (lines 505-515) - Widget DI setup
4. `Packages/DWNetworking/Sources/DWNetworking/NetworkService.swift` - Network layer

**Backend endpoints to understand:**
1. `.repos/dormway-platform/services/api-router/src/routes/dashboard-routes.ts` - Composite API
2. `.repos/dormway-platform/services/api-router/src/middleware/auth.ts` - Auth methods
3. `.repos/dormway-platform/services/api-router/src/services/ably-service.ts` - Real-time

### Test Your Understanding

**Can you answer these?**
1. Why do widgets use the composite API instead of separate endpoints?
2. Why is device key authentication preferred over JWT for widgets?
3. Why must DWDesign tokens be used instead of hardcoded values?
4. What are the 5 core user journeys and why is the line snapped?
5. How does the context hierarchy work (City â†’ Campus â†’ Building â†’ Course â†’ Student)?

**If you can't answer these, re-read the Context Guide!**

---

## ğŸš¦ When to Ask for Help

### Stop and Ask When:

1. **Scope unclear** - Feature not in 5 core journeys
2. **API missing** - Endpoint you need doesn't exist
3. **Privacy concerns** - Unsure if data is sensitive
4. **DWDesign gap** - Token you need doesn't exist
5. **Performance issue** - Widget takes >2 seconds to load
6. **Architecture conflict** - Pattern conflicts with system

### Proceed Confidently When:

1. **Using composite API** - `GET /dashboard/v1/composite`
2. **Following DWDesign** - All tokens, no hardcoded values
3. **Implementing core widgets** - Schedule, assignments, Ace, next action
4. **Adding real-time** - Ably integration
5. **Improving UX** - Better loading/error states
6. **Writing tests** - Unit tests, snapshot tests

---

## ğŸ“‹ Pre-Implementation Checklist

Before you start coding, verify:

- [ ] I've read all 3 essential guides (Context, iOS Patterns, Backend Integration)
- [ ] I understand what DormWay is and who the users are
- [ ] I know why widgets matter for daily engagement
- [ ] I've explored the existing widget code in `.repos/ios-clean/`
- [ ] I've reviewed the DWDesign package and understand token usage
- [ ] I know which widgets are priority (Next Action, Ace, Schedule, Assignments)
- [ ] I understand the beta scope (5 core journeys, line is snapped)
- [ ] I've verified the backend endpoints exist (`GET /dashboard/v1/composite`)
- [ ] I know how to authenticate (device key preferred)
- [ ] I understand the context hierarchy (City â†’ Campus â†’ Building â†’ Course â†’ Student)

**If you've checked all boxes, you're ready to start implementing! ğŸš€**

---

## ğŸ¯ Success Criteria

**Your implementation is successful when:**

1. âœ… Widgets fetch real data from `GET /dashboard/v1/composite`
2. âœ… Authentication works via device key (with JWT fallback)
3. âœ… All styling uses DWDesign tokens (no hardcoded values)
4. âœ… Widgets are glanceable (<5 seconds to understand)
5. âœ… Widgets are context-aware (show relevant data for time/location)
6. âœ… Error states are user-friendly (not technical error messages)
7. âœ… Loading states use cached data (no blank screens)
8. âœ… ETag caching works (304 Not Modified responses)
9. âœ… Real-time updates optional but implemented (Ably)
10. âœ… Tests pass (unit tests for data provider)
11. âœ… Widget views work on both small and medium sizes
12. âœ… Accessibility works (VoiceOver labels, Dynamic Type)

---

## ğŸ“ Additional Resources

### In the Repository

- **CLAUDE.md files** - Guidance for AI developers (workspace, ios-clean, dormway-platform)
- **README files** - Package-specific documentation
- **Memory/** - Recent development context (obsidian-vault)
- **Bug Reports/** - Known issues and resolutions

### External Documentation

- **WidgetKit** - [Apple Developer Docs](https://developer.apple.com/documentation/widgetkit)
- **SwiftUI** - [Apple Developer Docs](https://developer.apple.com/documentation/swiftui)
- **Swift Concurrency** - [Swift.org](https://docs.swift.org/swift-book/LanguageGuide/Concurrency.html)

---

## ğŸ‰ Ready to Build!

You now have everything you need to implement DormWay widgets:

1. âœ… **Context** - You understand WHY
2. âœ… **Patterns** - You know HOW (iOS)
3. âœ… **Integration** - You know HOW (Backend)
4. âœ… **Resources** - You know WHERE to look
5. âœ… **Scope** - You know WHAT to build

**Start with the Context Guide, then move to iOS Patterns, then Backend Integration.**

**Build features that help students succeed. Make widgets glanceable, contextual, and privacy-respecting.**

**Let's make something amazing! ğŸš€**

---

**Last Updated:** 2025-11-06
**Owner:** iOS Team
**Status:** Current

**Questions?** Review the guides, check CLAUDE.md files, or ask the user for clarification.
